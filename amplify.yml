version: 0.1
frontend:
  phases:
    preBuild:
      commands:
        - yarn install
        - yarn web:install
    build:
      commands:
        - GITHUB_PAT_READ_ALL_USER_PROFILE_DATA=$GITHUB_PAT_READ_ALL_USER_PROFILE_DATA GATSBY_GOOGLE_ANALYTICS_TRACKING_ID=$GATSBY_GOOGLE_ANALYTICS_TRACKING_ID GATSBY_GOOGLE_GLOBAL_SITE_TAG=$GATSBY_GOOGLE_GLOBAL_SITE_TAG GATSBY_SITE_URL=$GATSBY_SITE_URL yarn web:build
  artifacts:
    baseDirectory: /packages/web/public
    files:
      - '**/*'
  cache:
    paths:
      - node_modules/**/*
      - packages/shared/node_modules/**/*
      - packages/shared-web/node_modules/**/*
      - packages/web/node_modules/**/*
